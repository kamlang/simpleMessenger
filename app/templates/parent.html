{% extends 'bootstrap/base.html' %}

{% block title %}
    {% if title %}{{ title }}{% else %} simpleMessenger {% endif %}
{% endblock %}

{% block navbar %}
<body style="background-color: #7d9ac6;">
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Links -->
    <ul class="nav navbar-nav navbar-left">
{% if current_user.is_authenticated %}
      <li class="nav-item">
      	<a href={{url_for('main.conversations' )}} class="nav-link">My conversations</a>
      </li>
      <li class="nav-item">
    <a href="{{url_for('auth.logout')}}" class="nav-link">Logout</a>
      </li>
      {%else%}
      <li class="nav-item">
      <a href="{{url_for('auth.register')}}" class="nav-link">Register</a>
      </li>
      <li class="nav-item">
      	<a href="{{url_for('auth.login')}}" class="nav-link">Login</a>
      </li>
      {%endif%}
      {% if current_user.is_role(role='Admin') %}
      <li class="nav-item">
      	<a class="nav-link" href="{{url_for('restricted.showall')}}">Admin panel</a>
      </li>
      {%endif%}
    </ul>
    {%if current_user.username %}
    <ul class="nav navbar-nav navbar-right">
      <li class="nav-item navbar-right" align="right">
	      <a class="navlink">Logged in as:  {{current_user.username}}</a>
      </li>
    </ul>
    {%endif%}
  </div>
</nav>
{% endblock %}

{% block content %}
	<link href="/static/styles.css" rel="stylesheet">
        {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-info" role="alert">{{ message }}</div>
            {% endfor %}
        {% endif %}
        {% endwith %}
	<script>
		async function get_user_info(username) {
		let response = await fetch('/getUserInfo/'+username,
				{ headers:{'X-CSRFToken': csrf_token }})
				let json = await response.json()
				return json
		}
	</script>
        {# application content needs to be provided in the app_content block #}
	{%block app_content%}{%endblock%}
{% endblock %}

</body>

{% block scripts %}
    {{ super() }}
    {{ moment.include_moment() }}
{% endblock %}
